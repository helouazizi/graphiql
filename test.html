<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>XP Progression SVG Graph</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background: #f9f9f9;
    }
    svg {
      border: 1px solid #ccc;
      background: #fff;
      max-width: 800px;
      width: 100%;
      height: 300px;
    }
    .axis path,
    .axis line {
      stroke: #888;
      stroke-width: 1;
    }
    .grid line {
      stroke: #ddd;
      stroke-width: 1;
      stroke-dasharray: 4 2;
    }
    .label {
      font-size: 10px;
      fill: #666;
    }
  </style>
</head>
<body>
  <h2>XP Progression Over Time (SVG)</h2>
  <svg id="chart" viewBox="0 0 800 300" aria-label="XP progression chart"></svg>

  <script>
    const xpData = [
      { date: "2024-10-10", xp: 9100 },
      { date: "2024-10-15", xp: 9100 },
      { date: "2024-10-24", xp: 9200 },
      { date: "2024-11-06", xp: 6125 },
      { date: "2024-11-14", xp: 5350 },
      { date: "2024-11-21", xp: 4750 },
      { date: "2024-12-05", xp: 12250 },
      { date: "2024-12-11", xp: 1825 },
      { date: "2024-12-15", xp: 3150 },
      { date: "2024-12-16", xp: 2100 },
      { date: "2024-12-19", xp: 1750 },
      { date: "2024-12-26", xp: 34375 },
      { date: "2025-01-02", xp: 9100 },
      { date: "2025-01-10", xp: 5950 },
      { date: "2025-01-30", xp: 1925 },
      { date: "2025-02-20", xp: 1925 },
      { date: "2025-03-12", xp: 2975 },
      { date: "2025-04-27", xp: 12250 }
    ];

    const svg = document.getElementById('chart');
    const width = 800;
    const height = 300;
    const padding = 50;

    // Extract XP values and dates
    const xpValues = xpData.map(d => d.xp);
    const dates = xpData.map(d => d.date);

    // Find max XP for scale
    const maxXP = Math.max(...xpValues);
    const minXP = 0;

    // Create scaling functions
    const scaleX = (i) => padding + (i * (width - 2 * padding)) / (xpData.length - 1);
    const scaleY = (xp) => height - padding - ((xp - minXP) * (height - 2 * padding)) / (maxXP - minXP);

    // Draw grid lines on Y axis (5 steps)
    for (let i = 0; i <= 5; i++) {
      const y = padding + i * ( (height - 2 * padding) / 5);
      const xpLevel = Math.round(maxXP - i * (maxXP / 5));
      // grid line
      const gridLine = document.createElementNS("http://www.w3.org/2000/svg", "line");
      gridLine.setAttribute("x1", padding);
      gridLine.setAttribute("y1", y);
      gridLine.setAttribute("x2", width - padding);
      gridLine.setAttribute("y2", y);
      gridLine.setAttribute("class", "grid");
      svg.appendChild(gridLine);
      // label
      const label = document.createElementNS("http://www.w3.org/2000/svg", "text");
      label.setAttribute("x", padding - 10);
      label.setAttribute("y", y + 4);
      label.setAttribute("text-anchor", "end");
      label.setAttribute("class", "label");
      label.textContent = xpLevel;
      svg.appendChild(label);
    }

    // Draw X axis labels (dates) every 3 points approx
    for (let i = 0; i < dates.length; i += 3) {
      const x = scaleX(i);
      const label = document.createElementNS("http://www.w3.org/2000/svg", "text");
      label.setAttribute("x", x);
      label.setAttribute("y", height - padding + 15);
      label.setAttribute("text-anchor", "middle");
      label.setAttribute("class", "label");
      label.textContent = dates[i];
      svg.appendChild(label);
    }

    // Draw axes
    const axisX = document.createElementNS("http://www.w3.org/2000/svg", "line");
    axisX.setAttribute("x1", padding);
    axisX.setAttribute("y1", height - padding);
    axisX.setAttribute("x2", width - padding);
    axisX.setAttribute("y2", height - padding);
    axisX.setAttribute("class", "axis");
    svg.appendChild(axisX);

    const axisY = document.createElementNS("http://www.w3.org/2000/svg", "line");
    axisY.setAttribute("x1", padding);
    axisY.setAttribute("y1", padding);
    axisY.setAttribute("x2", padding);
    axisY.setAttribute("y2", height - padding);
    axisY.setAttribute("class", "axis");
    svg.appendChild(axisY);

    // Build the polyline points string
    const points = xpData.map((d, i) => `${scaleX(i)},${scaleY(d.xp)}`).join(" ");

    // Draw polyline for XP data
    const polyline = document.createElementNS("http://www.w3.org/2000/svg", "polyline");
    polyline.setAttribute("points", points);
    polyline.setAttribute("fill", "none");
    polyline.setAttribute("stroke", "blue");
    polyline.setAttribute("stroke-width", "2");
    svg.appendChild(polyline);

    // Draw circles for each point and add simple tooltip on hover
    xpData.forEach((d, i) => {
      const cx = scaleX(i);
      const cy = scaleY(d.xp);

      const circle = document.createElementNS("http://www.w3.org/2000/svg", "circle");
      circle.setAttribute("cx", cx);
      circle.setAttribute("cy", cy);
      circle.setAttribute("r", 4);
      circle.setAttribute("fill", "red");

      // Tooltip using title tag inside SVG
      const title = document.createElementNS("http://www.w3.org/2000/svg", "title");
      title.textContent = `${d.date}: ${d.xp} XP`;
      circle.appendChild(title);

      svg.appendChild(circle);
    });
  </script>
</body>
</html>
